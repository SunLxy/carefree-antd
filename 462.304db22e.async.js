"use strict";(self.webpackChunkcarefree_antd_root=self.webpackChunkcarefree_antd_root||[]).push([[462],{8462:function(Kt,Y,n){n.r(Y),n.d(Y,{Store:function(){return te},default:function(){return gt}});var je=n(15009),k=n.n(je),De=n(19632),Se=n.n(De),Fe=n(9783),Ke=n.n(Fe),Te=n(5574),O=n.n(Te),Ie=n(15861),i=n(87462),U=n(63366),D=n(67294),q=n(45360),Ve=n(95639),Pe=n(71577),Re=n(72004),$e=n.n(Re),Ne=n(12444),Oe=n.n(Ne),_=$e()(function c(){var e=this;Oe()(this,c),this.store={},this.remove=function(t){delete e.store[t]},this.register=function(t,o){e.store[t]=o},this.getStore=function(){return e.store},this.getToKeyForm=function(t){return e.store[""+t]}}),ee=function(e){var t=D.useRef();return e?t.current=e:t.current=new _,[t.current]},te=_,B=n(66836),a=n(85893),Be=void 0,ne=D.createContext({formsRef:new te,dataSource:[],rowKey:"id",onValuesChange:function(e,t,o,g){}}),Le=function(e){var t=B.ZP.useForm(),o=O()(t,1),g=o[0],r=D.useContext(ne),y=r.formsRef,v=r.onValuesChange,h=v===void 0?function(){}:v,u=r.dataSource,A=r.rowKey;D.useEffect(function(){return function(){return y.remove(""+e["data-row-key"])}},[]),y.register(""+e["data-row-key"],g);var C=u.find(function(p){return""+p[A]==""+e["data-row-key"]});return(0,a.jsx)(B.ZP,{onValuesChange:h.bind(Be,""+e["data-row-key"],g),form:g,name:""+e["data-row-key"],component:!1,initialValues:C||{},children:(0,a.jsx)("tr",(0,i.Z)({},e))})},we=Le,be=n(83062),re=n(22174),ie=n(69677),Ge=n(17376),Me=n(49288),ze=n(69606),He=n(34913),Ue=n(71338),We=n(59847),Je=n(34041),Qe=n(32808),Xe=n(11330),Ye=n(55742),ke=n(72269),qe=n(68351),_e=n(23799),et=re.Z.RangePicker;function tt(c,e){if(c.length){var t=c.join("_");return e?e+"_"+t:t}}function nt(c){return c===void 0||c===!1?[]:Array.isArray(c)?c:[c]}var rt=function(e){var t=e.attr,o=e.type,g=e.inputNode,r=void 0;if(o==="Input"){var y=t;r=(0,a.jsx)(ie.Z,(0,i.Z)({},y))}else if(o==="TextArea"){var v=t;r=(0,a.jsx)(ie.Z.TextArea,(0,i.Z)({},v))}else if(o==="InputNumber"){var h=t;r=(0,a.jsx)(Ge.Z,(0,i.Z)({},h))}else if(o==="AutoComplete"){var u=t;r=(0,a.jsx)(Me.Z,(0,i.Z)({},u))}else if(o==="Cascader"){var A=t;r=(0,a.jsx)(ze.Z,(0,i.Z)({},A))}else if(o==="DatePicker"){var C=t;r=(0,a.jsx)(re.Z,(0,i.Z)({},C))}else if(o==="Rate"){var p=t;r=(0,a.jsx)(He.Z,(0,i.Z)({},p))}else if(o==="Slider"){var F=t;r=(0,a.jsx)(Ue.Z,(0,i.Z)({},F))}else if(o==="TreeSelect"){var Z=t;r=(0,a.jsx)(We.Z,(0,i.Z)({},Z))}else if(o==="Select"){var R=t;r=(0,a.jsx)(Je.Z,(0,i.Z)({},R))}else if(o==="Checkbox"){var I=t;r=(0,a.jsx)(Qe.Z.Group,(0,i.Z)({},I))}else if(o==="Mentions"){var f=t;r=(0,a.jsx)(Xe.Z,(0,i.Z)({},f))}else if(o==="Radio"){var x=t;r=(0,a.jsx)(Ye.ZP.Group,(0,i.Z)({},x))}else if(o==="Switch"){var V=t;r=(0,a.jsx)(ke.Z,(0,i.Z)({},V))}else if(o==="TimePicker"){var K=t;r=(0,a.jsx)(qe.Z,(0,i.Z)({},K))}else if(o==="Upload"){var T=t;r=(0,a.jsx)(_e.Z,(0,i.Z)({},T))}else if(o==="RangePicker"){var E=t;r=(0,a.jsx)(et,(0,i.Z)({},E))}else o==="Custom"&&(r=g);return r},it=["editing","dataIndex","title","record","index","inputNode","rules","children","itemAttr","type","attr","tip","tipAttr","multiple","rowKey","isList","listAttr"],at=["name","rules","preName","itemValue","children","tipAttr","tip"],ot=function(e){var t=e.editing,o=e.dataIndex,g=e.record,r=e.inputNode,y=e.rules,v=e.children,h=e.itemAttr,u=e.type,A=e.attr,C=e.tip,p=e.tipAttr,F=e.rowKey,Z=e.isList,R=e.listAttr,I=R===void 0?{}:R,f=(0,U.Z)(e,it),x=rt({attr:A,type:u,inputNode:r}),V=function(){return Z&&typeof r=="function"?(0,a.jsx)(B.ZP.List,(0,i.Z)({},I,{name:o,children:function(E,N,w){return r(E.map(function(b){return(0,i.Z)({},b,{fieldKey:b.key})}),N,w)}})):(0,a.jsx)(ae,(0,i.Z)({},h,{name:o,rules:y,preName:g[F],itemValue:g,children:x,tipAttr:p,tip:C}))};return(0,a.jsx)("td",(0,i.Z)({},f,{children:t?V():v}))},ae=function(e){var t=e.name,o=e.rules,g=e.preName,r=g===void 0?"":g,y=e.itemValue,v=e.children,h=e.tipAttr,u=h===void 0?{}:h,A=e.tip,C=(0,U.Z)(e,at);return(0,a.jsx)(B.ZP.Field,(0,i.Z)({},C,{name:t,rules:o,children:function(F,Z,R){var I=nt(t).length&&Z?Z.name:[],f=tt(I,r),x=function(E){var N=E;E&&E.target&&(N=E.target.value),F.onChange(N)},V=typeof v=="function"?v((0,i.Z)({},F,{id:f}),Z,R,{record:y}):D.isValidElement(v)?D.cloneElement(v,(0,i.Z)({},F,{onChange:x,id:f})):v,K=Z.errors.map(function(T){return T}).join(",");return(0,a.jsx)(be.Z,(0,i.Z)({color:"#fff",overlayInnerStyle:{color:"red"}},u,{title:A?A(K):K,visible:!!Z.errors.length,children:V}))}}))},st=ot,L=n(48997),oe=n(86738),lt=n(26713),se=void 0,dt=function(e){var t=e.optConfig,o=e.isEditing,g=e.isAddEdit,r=e.save,y=e.isOptDelete,v=e.cancel,h=e.onDelete,u=e.edit,A=e.newAdd,C=e.editingKey,p=e.rowKey,F=e.multiple,Z=e.optDeleteEditingDisabled;return[(0,i.Z)({title:"\u64CD\u4F5C",align:"center",width:120},t,{render:function(I,f,x){var V=o(f),K=g(f);return t&&t.render?t.render(I,f,x,{editable:V,isNewAdd:K,save:r,cancel:v,onDelete:h,edit:u,newAdd:A,editingKey:C}):V?(0,a.jsxs)("span",{children:[(0,a.jsx)(L.Z.Link,{onClick:function(){return r(f[p],f,x)},style:{marginRight:8},children:"\u4FDD\u5B58"}),(0,a.jsx)(oe.Z,{title:"\u662F\u5426\u53D6\u6D88\u5F53\u524D\u884C\u7F16\u8F91?",okText:"\u662F",cancelText:"\u5426",onConfirm:K?h.bind(se,f[p],f,x):v.bind(se,f[p]),children:(0,a.jsx)(L.Z.Link,{children:"\u53D6\u6D88"})})]}):(0,a.jsxs)(lt.Z,{children:[(0,a.jsx)(L.Z.Link,{disabled:!!C.length&&!F,onClick:function(){return u(f)},children:"\u7F16\u8F91"}),y&&(0,a.jsx)(oe.Z,{disabled:Z&&!!C.length,title:"\u662F\u5426\u5220\u9664\u5F53\u524D\u884C\u6570\u636E?",okText:"\u662F",cancelText:"\u5426",onConfirm:function(){return h(f[p],f,x)},children:(0,a.jsx)(L.Z.Link,{disabled:Z&&!!C.length,children:"\u5220\u9664"})})]})}})]},ut=dt,vt=["columns","dataSource","onBeforeSave","onSave","rowKey","optIsFirst","optConfig","isOptDelete","initValue","onValuesChange","isAdd","onErr","multiple","onBeforeAdd","isOpt","addBtnProps","store","optDeleteEditingDisabled"],ft=function(e,t){var o=e.columns,g=e.dataSource,r=g===void 0?[]:g,y=e.onBeforeSave,v=e.onSave,h=e.rowKey,u=h===void 0?"id":h,A=e.optIsFirst,C=A===void 0?!1:A,p=e.optConfig,F=p===void 0?{}:p,Z=e.isOptDelete,R=Z===void 0?!1:Z,I=e.initValue,f=I===void 0?{}:I,x=e.onValuesChange,V=e.isAdd,K=e.onErr,T=e.multiple,E=T===void 0?!1:T,N=e.onBeforeAdd,w=e.isOpt,b=w===void 0?!0:w,le=e.addBtnProps,de=le===void 0?{}:le,ht=e.store,ue=e.optDeleteEditingDisabled,Zt=ue===void 0?!1:ue,Ct=(0,U.Z)(e,vt),pt=ee(ht),yt=O()(pt,1),G=yt[0],At=(0,D.useState)([]),ve=O()(At,2),M=ve[0],J=ve[1],xt=D.useState([]),fe=O()(xt,2),z=fe[0],ce=fe[1],Q=function(s){J(function(d){return d.filter(function(m){return""+m!=""+s})}),ce(function(d){return d.filter(function(m){return""+m!=""+s})})},Et=D.useMemo(function(){return o.filter(function(l){return l.editable}).map(function(l){return l.dataIndex})},[o]),me=function(s,d){d===void 0&&(d={});var m=G.getStore();m[""+s]&&m[""+s].setFieldsValue(d)},ge=function(s){var d=G.getStore();return d[""+s]},X=function(s){return M.includes(""+s[u])},he=function(s){return z.includes(""+s[u])},Ze=function(){if(!(N&&!N())){if(z.length===1&&!E){q.ZP.warn("\u53EA\u80FD\u65B0\u589E\u4E00\u884C");return}if(M.length===1&&!E){q.ZP.warn("\u53EA\u80FD\u7F16\u8F91\u4E00\u884C");return}var s=(new Date().getTime()*Math.round(10)).toString(),d=(0,i.Z)({},f||{},Ke()({},u,s)),m=r.concat([d]);J(function(S){return S.concat([s])}),ce(function(S){return S.concat([s])}),v&&v(m,d)}},Ce=function(s){var d=(0,i.Z)({},s);me(s[u],d),J(function(m){return m.concat([""+s[u]])})},pe=function(s){Q(s),me(s,{})},ye=function(s,d,m){var S=r.filter(function($){return""+$[u]!=""+s});Q(s),v&&v(S,d,d,m)},Ae=function(){var l=(0,Ie.Z)(k()().mark(function s(d,m,S){var $,P,H,Ee;return k()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,j.next=3,ge(d).validateFields();case 3:if($=j.sent,!(y&&!y($,m,S))){j.next=6;break}return j.abrupt("return");case 6:P=Se()(r),H=P.findIndex(function(Ft){return""+d==""+Ft[u]}),H>-1?(Ee=P[H],P.splice(H,1,(0,i.Z)({},Ee,$))):P.push($),v&&v(P,$,m,S),Q(d),ge(d).resetFields(Et),j.next=17;break;case 14:j.prev=14,j.t0=j.catch(0),K&&K(j.t0);case 17:case"end":return j.stop()}},s,null,[[0,14]])}));return function(d,m,S){return l.apply(this,arguments)}}(),xe=b&&ut({optConfig:F,isEditing:X,isAddEdit:he,save:Ae,isOptDelete:R,cancel:pe,onDelete:ye,edit:Ce,newAdd:z,editingKey:M,rowKey:u,multiple:E,optDeleteEditingDisabled:Zt})||[],jt=C?xe.concat(o):o.concat(xe),Dt=jt.map(function(l){return l.editable?(0,i.Z)({},l,{onCell:function(d){return{record:d,multiple:E,rowKey:u,dataIndex:l.dataIndex,title:l.title,editing:X(d),inputNode:l.inputNode,rules:l.rules||[],itemAttr:l.itemAttr,type:l.type,attr:l.attr,tip:l.tip,tipAttr:l.tipAttr,isList:l.isList,listAttr:l.listAttr}}}):l}),St=function(s,d,m,S){if(x){var $=r.map(function(P){return""+s==""+P[u]?(0,i.Z)({},P,S):(0,i.Z)({},P)});x($,m,S,s,d)}};return D.useImperativeHandle(t,function(){return{save:Ae,onDelete:ye,edit:Ce,cancel:pe,add:Ze,isEditing:X,editingKey:M,newAdd:z,isAddEdit:he,forms:G}}),(0,a.jsx)(D.Fragment,{children:(0,a.jsxs)(ne.Provider,{value:{formsRef:G,onValuesChange:St,dataSource:r,rowKey:u},children:[(0,a.jsx)(Ve.Z,(0,i.Z)({size:"small",bordered:!0},Ct,{components:{body:{row:we,cell:st}},rowKey:u,dataSource:r,columns:Dt,rowClassName:"editable-row",pagination:!1})),V&&(0,a.jsx)(Pe.ZP,(0,i.Z)({type:"dashed",block:!0,children:"\u6DFB\u52A0\u4E00\u884C\u6570\u636E"},de||{},{style:(0,i.Z)({marginTop:10},(de||{}).style||{}),onClick:Ze}))]})})},ct=D.forwardRef(ft),W=ct;W.useStore=ee,W.Item=ae;var mt=W,gt=mt}}]);
