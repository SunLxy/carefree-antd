"use strict";(self.webpackChunkcarefree_antd_root=self.webpackChunkcarefree_antd_root||[]).push([[251],{93251:function(ye,O,u){u.r(O),u.d(O,{default:function(){return ne}});var K=u(9783),C=u.n(K),B=u(5574),b=u.n(B),P=u(35223),Z=u(78200),G=u(55241),H=u(34041),Q=u(57953),U=u(96486),i=u(67294),X=u(95639),m=u(85893),Y=["value","width","onClick","mode","labelInValue","ValueField"],q=function(e,r,y,f,c){if(["tags","multiple"].includes(y)&&Array.isArray(r)){var g=r.find(function(d){return f&&d?d[c]===e[c]:d===r});if(g)return!0}else return f&&r?r[c]===e[c]:r===e[c];return!1},p=function(s){var e=s.value,r=s.width,y=s.onClick,f=s.mode,c=s.labelInValue,g=s.ValueField,d=(0,Z.Z)(s,Y),R=i.useCallback(q,[JSON.stringify(e)]),V=function(x){var I=R(x,e,f,c,g);return{onClick:function(){return y(x,!I)},style:I&&{background:"#e6f7ff"}||{}}};return(0,m.jsx)("div",{className:"fuzzy-query-table",children:(0,m.jsx)(X.Z,(0,P.Z)({rowKey:g,onRow:V,size:"small",pagination:!1,style:{width:r},scroll:{y:300},columns:[{dataIndex:"label",title:"\u540D\u79F0"},{dataIndex:"value",title:"\u7F16\u53F7"}]},d))})},_=["onChange","labelInValue","columns","request","debounceTimeout","tipWidth","fieldNames"],ee=[{dataIndex:"label",title:"\u540D\u79F0"},{dataIndex:"value",title:"\u7F16\u53F7"}],te=function(e){var r=e.onChange,y=e.labelInValue,f=y===void 0?!0:y,c=e.columns,g=c===void 0?ee:c,d=e.request,R=e.debounceTimeout,V=R===void 0?800:R,N=e.tipWidth,x=e.fieldNames,I=(0,Z.Z)(e,_),W=i.useState(0),w=b()(W,2),le=w[0],F=w[1],ue=i.useState(!1),z=b()(ue,2),L=z[0],A=z[1],re=i.useState(!1),M=b()(re,2),ie=M[0],k=M[1],fe=i.useState([]),D=b()(fe,2),E=D[0],J=D[1],$=i.useRef(!0),o=i.useMemo(function(){return e.fieldNames&&e.fieldNames.value||"value"},[e.fieldNames]),S=i.useMemo(function(){return e.fieldNames&&e.fieldNames.label||"label"},[e.fieldNames]),j=i.useRef(null);i.useLayoutEffect(function(){if(j.current)if(N)F(N);else{var v=j.current.offsetWidth;F(v-30)}},[]);var oe=function(a){var n,t=a||{},l=t[o],h=t[S];return n={},C()(n,o,l),C()(n,S,h),n},ce=function(a,n){var t=oe(a);if(f||(t=a&&t[o]),["tags","multiple"].includes(e.mode))Array.isArray(e.value)?n?t=e.value.concat(t):t=e.value.filter(function(l){return f&&l?l[o]!==t[o]:l!==t}):n?t=[t]:t=[];else{if(k(!1),!n){t=void 0;return}$.current=!1}r&&r(t,a)},T=i.useRef(0),se=i.useMemo(function(){var v=function(n){if(!$.current){$.current=!0;return}T.current+=1;var t=T.current;d&&(A(!0),d(n).then(function(l){t===T.current&&(J(l),A(!1))}).catch(function(){J([]),A(!1)}))};return(0,U.debounce)(v,V)},[d,V]),de=function(){var a=E.map(function(n){var t,l=n[o],h=n[S];return t={},C()(t,o,l),C()(t,S,h),t});return a},ve=function(){if(Array.isArray(e.value)&&f)return e.value.map(function(l){var h=l[o],me=l[S];return{label:me,value:h}});if(e.value&&!e.mode&&f){var a=e.value,n=a[o],t=a[S];return{label:t,value:n}}return e.value},he=function(a,n){var t=a;a&&Array.isArray(a)&&Array.isArray(e.value)&&(f?t=e.value.filter(function(l){return!!a.find(function(h){return h.value===l[o]})}):t=e.value.filter(function(l){return!!a.find(function(h){return h===l})})),r&&r(t,n)};return(0,m.jsx)(G.Z,{trigger:"click",placement:"bottomLeft",open:ie,onOpenChange:function(a){k(a)},content:(0,m.jsx)(p,{columns:g,dataSource:E,value:e.value,width:le,mode:e.mode,labelInValue:f,onClick:ce,loading:L,ValueField:o}),children:(0,m.jsx)("div",{ref:j,className:"popover-select-warp",style:{width:"100%"},children:(0,m.jsx)(H.Z,(0,P.Z)({allowClear:!0,labelInValue:f,filterOption:!1,style:{width:"100%"},onSearch:se,showSearch:!0,fieldNames:x},I,{value:ve(),notFoundContent:L?(0,m.jsx)(Q.Z,{size:"small"}):null,onChange:he,options:de(),dropdownStyle:{display:"none"}}))})})},ae=te,ne=ae}}]);
