(self.webpackChunkcarefree_antd_root=self.webpackChunkcarefree_antd_root||[]).push([[834,729],{28209:function(Oe,$,u){"use strict";u.r($),u.d($,{default:function(){return Ee}});var ae=u(5574),C=u.n(ae),f=u(67294),o=u(23777),G=u(34077),re=u(12444),ne=u.n(re),ie=u(72004),oe=u.n(ie),J=u(56217),j=u(72278),se=["search","table"],W=function(){function c(t){var e=this;ne()(this,c),this.store={search:{},loading:!1,table:{page:1,pageSize:20,total:0,dataSource:[],selectRows:[],selectRowKeys:[]}},this.initialValues={search:{},loading:!1,table:{page:1,pageSize:20,total:0,dataSource:[],selectRows:[],selectRowKeys:[]}},this.components={},this.getStringToArr=function(r){return r.split("_")},this.getInitValue=function(r){return(0,j.d9)((0,j.U2)(e.initialValues,e.getStringToArr(r)),!1)},this.getValue=function(r){return(0,j.U2)(e.store,e.getStringToArr(r))},this.setValue=function(r,a){return e.store=(0,j.t8)(e.store,e.getStringToArr(r),a),e.store},this.setBatchValue=function(r){return Object.entries(r).forEach(function(a){var i=C()(a,2),d=i[0],v=i[1];e.store=(0,j.t8)(e.store,e.getStringToArr(d),v)}),e.store},this.getStore=function(){return e.store},this.registerId=function(r,a){e.components[r]=a},this.unregister=function(r,a){delete e.components[r],r==="search"?e.setValue(r,a||e.initialValues.search||{}):r==="table"?e.setValue(r,a||e.initialValues.table||{page:1,pageSize:20,total:0,dataSource:[],selectRows:[],selectRowKeys:[]}):e.setValue(r,a||e.initialValues[r])},this.tableLoading=function(r){e.setValue("loading",r),e.updateComponent(["table"])},this.updateComponent=function(r){r.forEach(function(a){e.components[a]()})};var l=t||{},n=l.search,h=l.table,m=(0,J.Z)(l,se);n&&this.setValue("search",(0,o.Z)({},n)),h&&this.setValue("table",(0,o.Z)({},h)),Object.entries((0,o.Z)({},m)).forEach(function(r){var a=C()(r,2),i=a[0],d=a[1];e.setValue(i,d)}),this.initialValues=(0,j.d9)(t||{},!1)}return oe()(c,[{key:"stores",get:function(){return this.store}}]),c}(),Q=function(t){var e=t.main,l=t.initialValues,n=f.useRef();return e?n.current=e:n.current=new W(l),[n.current]},X=f.createContext(new W),Y=function(){return f.useContext(X)},k=f.createContext({}),U=function(){return f.useContext(k)},ue=u(15009),q=u.n(ue),le=u(82862),ce=u(11238),fe=u(29581),de=["requestType","headers","data","module"],ge=function(t,e){var l=e.requestType,n=e.headers,h=e.data,m=e.module,r=(0,J.Z)(e,de),a=(0,o.Z)({},n||{}),i=h;l==="json"?(a=(0,o.Z)({Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},a),typeof i!="string"&&(i=JSON.stringify(i))):l==="form"?(a=(0,o.Z)({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},a),i=typeof i=="string"?i:fe.stringify(i)):a=(0,o.Z)({Accept:"application/json"},a);var d=t;if(m){var v=/^\//.test(t);d="/"+m+(v?"":"/")+t}return(0,ce.ZP)(d,(0,o.Z)({requestType:l,headers:(0,o.Z)({},a),data:i},r))},A=ge,he=function(t,e){return A(t,(0,o.Z)({},e||{},{method:"POST"}))},ve=function(t,e){return A(t,(0,o.Z)({},e||{},{method:"GET"}))},me=function(t,e){return A(t,(0,o.Z)({},e||{},{method:"DELETE"}))},pe=function(t,e){return A(t,(0,o.Z)({},e||{},{method:"PUT"}))},be=function(t,e){return A(t,(0,o.Z)({},e||{},{method:"PATCH"}))},Ce=function(t,e){return A(t,(0,o.Z)({},e||{},{method:"HEAD"}))},Se=function(t,e){return A(t,(0,o.Z)({},e||{},{method:"OPTIONS"}))},Te={POST:he,GET:ve,DELETE:me,PUT:pe,PATCH:be,HEAD:Ce,OPTIONS:Se},_=function(){var c=(0,le.Z)(q()().mark(function t(e){var l,n,h,m,r,a,i,d,v,g,V,y,p,Z,F,b;return q()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(l=e.Api,n=e.main,h=e.tableConfig,m=e.apiName,r=n.setBatchValue,a=n.getValue,i=n.tableLoading,d=h||{},v=d.table,g=l[m||"table"]||{},g.url){s.next=6;break}return s.abrupt("return");case 6:if(s.prev=6,i(!0),r({table_page:(v||{}).page||1,table_pageSize:(v||{}).page||20}),V=!0,g.before&&(V=g.before(n)),V){s.next=14;break}return i(!1),s.abrupt("return");case 14:return y=(0,o.Z)({page:a("table_page"),pageSize:a("table_pageSize")},a("search")),g.requestBefore&&(y=g.requestBefore(n)),s.next=18,Te[g.method||"GET"](""+g.url,(0,o.Z)({},g.options||{},{module:g.module,data:y})).catch(function(D){i(!1)});case 18:p=s.sent,g.requestAfter?g.requestAfter({response:p,main:n}):p&&p.code===200&&(Z=p.data||{},F=Z.rows,b=Z.total,r({table_dataSource:F||[],table_total:b||0})),i(!1),s.next=26;break;case 23:s.prev=23,s.t0=s.catch(6),i(!1);case 26:case"end":return s.stop()}},t,null,[[6,23]])}));return function(e){return c.apply(this,arguments)}}(),ee=u(59652),S=u(85893),Pe=function(){var t=U(),e=t.search,l=t.tableConfig,n=t.searchCardProps,h=t.searchHead,m=U(),r=m.Api,a=r===void 0?{}:r,i=Y(),d=i.setValue,v=i.registerId,g=i.unregister,V=i.getInitValue,y=f.useState(""),p=C()(y,2),Z=p[0],F=p[1],b=e||{},T=b.isSearch,s=b.initialValues,D=b.form,w=b.apiName,B=G.default.useForm(D),K=C()(B,1),E=K[0],O=function(){F(new Date().getTime().toString())},M=function(P,H){d("search",H)};f.useEffect(function(){s&&d("search",s||{})},[]),v("search",O),f.useEffect(function(){return function(){return g("search",s)}},[]),f.useEffect(function(){s&&(Object.entries(s).forEach(function(I){var P=C()(I,2),H=P[0],L=P[1];d("search_"+H,L)}),O())},[]);var x=f.useMemo(function(){return"bordered"in(n||{})?n.bordered:!!h},[!!h,(n||{}).bordered]);return(0,S.jsx)(ee.Z,(0,o.Z)({title:h&&h(i)},n||{},{style:(0,o.Z)({marginBottom:10},(n||{}).style||{}),bodyStyle:(0,o.Z)({padding:x?12:0},(n||{}).bodyStyle||{}),bordered:x,children:(0,S.jsx)(G.default,(0,o.Z)({form:E,initialValues:s||V("search")||{}},T?{onFinish:function(P){e&&e.onFinish?e.onFinish(P,i):_({main:i,tableConfig:l,Api:a,apiName:w})},onRest:function(){e&&e.onRest?e.onRest():(d("search",s||{}),E.resetFields())}}:{},e,{onValuesChange:M}))}))},Ae=Pe,Ve=u(88631),ye=function(){var t=U(),e=t.tableConfig,l=t.columns,n=t.tableCardProps,h=t.Api,m=h===void 0?{}:h,r=t.tableHead,a=Y(),i=a.getValue,d=a.setValue,v=a.setBatchValue,g=a.updateComponent,V=a.registerId,y=a.unregister,p=f.useState(""),Z=C()(p,2),F=Z[0],b=Z[1],T=i("table"),s=T.page,D=T.pageSize,w=T.total,B=T.dataSource,K=T.selectRowKeys,E=e||{},O=E.pagination,M=E.rowSelection,x=E.table,I=E.apiName,P=function(){b(new Date().getTime().toString())},H=function(R,N){v({table_page:R,table_pageSize:N}),e&&e.pagination&&e.pagination.onChange?e.pagination.onChange(R,N,a):_({main:a,tableConfig:e,Api:m,apiName:I})},L=f.useMemo(function(){return!!(e&&"pagination"in e&&O===!1)},[JSON.stringify(O)]);V("table",P),f.useEffect(function(){return function(){return y("table",x)}},[]),f.useEffect(function(){x&&(Object.entries(x).forEach(function(z){var R=C()(z,2),N=R[0],je=R[1];d("table_"+N,je)}),P())},[]);var Ie=f.useMemo(function(){return typeof l=="function"?l(a):l||[]},[l]),Re=f.useMemo(function(){return"bordered"in(n||{})?n.bordered:!!r},[!!r,(n||{}).bordered]);return(0,S.jsx)(ee.Z,(0,o.Z)({},n||{},{title:r&&r(a),bodyStyle:(0,o.Z)({padding:0},(n||{}).bodyStyle||{}),bordered:Re,children:(0,S.jsx)(Ve.Z,(0,o.Z)({rowKey:"id",size:"small",bordered:!0,loading:i("loading")},e,M?{rowSelection:(0,o.Z)({},M,{selectedRowKeys:K,onChange:function(R,N){v({"table.selectRowKeys":R,"table.selectRows":N}),g(["table"])}})}:{},{dataSource:B,columns:Ie,pagination:!L&&(0,o.Z)({},O||{},{pageSize:D,total:w,current:s,onChange:H})}))}))},Ze=ye,te=function(t){var e=Q({main:t.main,initialValues:t.initialValues}),l=C()(e,1),n=l[0];return(0,S.jsx)(X.Provider,{value:n,children:(0,S.jsxs)(k.Provider,{value:t,children:[(0,S.jsx)(Ae,{}),(0,S.jsx)(Ze,{})]})})};te.useMain=Q;var Ee=te},24654:function(){}}]);
